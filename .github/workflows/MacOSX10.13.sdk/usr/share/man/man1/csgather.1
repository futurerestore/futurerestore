.\"Modified from man(1) of FreeBSD, the NetBSD mdoc.template, and mdoc.samples.
.\"See Also:
.\"man mdoc.samples for a complete listing of options
.\"man mdoc for the short list of editing options
.\"/usr/share/misc/mdoc.template
.Dd 4/21/2014               \" DATE 
.Dt csgather 1      \" Program name and manual section number 
.Os OS X
.Sh NAME                 \" Section Header - required - don't modify 
.Nm csgather
.Nd Gather CoreStorage metadata for diagnosis
.Sh SYNOPSIS             \" Section Header - required - don't modify
.Nm
.Fl G Ar dir
.Ar device ...
.Nm
.Fl r Ar mountPoint
.Op Fl o Ar filename
.Sh DESCRIPTION          \" Section Header - required - don't modify
.Nm
gathers CoreStorage metadata for diagnosis.  It works in two modes.
.Pp
In the first mode where -G and a list of devices are provided, CoreStorage
metadata on these list of devices will be collected.  The collected
information includes the size and UUID of the CoreStorage logical and
physical volumes, the name of the logical volumes, the wrapped (encrypted)
volume key (which can
only be decrypted by a brute-force attack), user name and user login image
file.  No other user information (such as directory structure, file names,
file content, etc) is collected.
.Pp
In the second mode where -r is provided, the encryption
context which includes the wrapped volume key (which can only be decrypted by
a brute-force attack), user name and user login image file will be collected.
.Pp
If the wrapped volume key is decrypted by a brute-force attack, the volume
key used to encrypt data on CoreStorage Logical Volumes is in the clear.  It
is not mathematically possible to derive the user's passphrase from the
volume key.  The volume key is only useful when the attacker has access to
the encrypted data in the CoreStorage Logical Volume, which are not collected
by
.Nm .
.Pp
The following options are available:
.Bl -tag -width ".It Fl r Ar mountPoint"
.It Fl G Ar dir
Gather all CoreStorage metadata and write into the specified directory.  The given directory
must not already exist.
.It Fl o Ar filename
Specify the output file generated by the -r option.  If not given, use standard output.
.It Fl r Ar mountPoint
Find out the CoreStorage logical volume identified by the given mount point, and print its encryption
context to the file given in the -o option.
.El
.Pp
.Sh SEE ALSO
.Xr csdiagnose 1
.Sh HISTORY
The
.Nm
utility first appeared along with CoreStorage in OS X 10.10.0.
